# YTB2BILI - YouTube åˆ° Bilibili è‡ªåŠ¨åŒ–è½¬è½½ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è§†é¢‘è‡ªåŠ¨åŒ–å¤„ç†ç³»ç»Ÿï¼Œæ”¯æŒä» YouTube ç­‰å¹³å°ä¸‹è½½è§†é¢‘ï¼Œè‡ªåŠ¨ç”Ÿæˆå­—å¹•ã€ç¿»è¯‘å†…å®¹ã€ç”Ÿæˆå…ƒæ•°æ®ï¼Œå¹¶å®šæ—¶ä¸Šä¼ åˆ° Bilibiliã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¬ æ™ºèƒ½è§†é¢‘å¤„ç†é“¾

**4æ­¥å‡†å¤‡æµç¨‹ï¼ˆå®æ—¶å¤„ç†ï¼‰**ï¼š
1. **ğŸ¬ å­—å¹•ç”Ÿæˆ** - ä½¿ç”¨ Whisper AI è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡å­—å¹•
2. **ğŸ“· å°é¢ä¸‹è½½** - è‡ªåŠ¨ä¸‹è½½å¹¶ä¸Šä¼ é«˜æ¸…å°é¢åˆ°äº‘å­˜å‚¨
3. **ğŸŒ å­—å¹•ç¿»è¯‘** - æ”¯æŒç™¾åº¦ç¿»è¯‘å’Œ DeepSeek AI å¤šè¯­è¨€ç¿»è¯‘
4. **ğŸ¤– å…ƒæ•°æ®ç”Ÿæˆ** - AI åˆ†æè§†é¢‘å†…å®¹ï¼Œç”Ÿæˆç¬¦åˆ Bç«™è§„èŒƒçš„æ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾

**å®šæ—¶ä¸Šä¼ ç­–ç•¥ï¼ˆæ™ºèƒ½è°ƒåº¦ï¼‰**ï¼š
- **ğŸ¥ è§†é¢‘ä¸Šä¼ ** - æ¯å°æ—¶ä¸Šä¼ ä¸€ä¸ªå¤„ç†å®Œæˆçš„è§†é¢‘
- **ğŸ“ å­—å¹•ä¸Šä¼ ** - è§†é¢‘ä¸Šä¼ æˆåŠŸå1å°æ—¶è‡ªåŠ¨ä¸Šä¼ å­—å¹•

### ğŸ“Š å¯è§†åŒ–ç®¡ç†é¢æ¿
- **ğŸ“‹ è§†é¢‘åˆ—è¡¨** - å®æ—¶æŸ¥çœ‹æ‰€æœ‰è§†é¢‘çš„å¤„ç†çŠ¶æ€
- **ğŸ” è¯¦ç»†ä¿¡æ¯** - å®Œæ•´çš„è§†é¢‘ä¿¡æ¯å’Œå¤„ç†æ­¥éª¤è¿½è¸ª  
- **ğŸ¯ å•æ­¥é‡è¯•** - æ”¯æŒé‡æ–°æ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡æ­¥éª¤
- **ğŸ“ˆ è¿›åº¦ç›‘æ§** - å®æ—¶è¿›åº¦ç™¾åˆ†æ¯”å’Œå¤„ç†æ—¶é•¿ç»Ÿè®¡
- **ğŸ“ æ–‡ä»¶ç®¡ç†** - æŸ¥çœ‹å’Œä¸‹è½½æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆè§†é¢‘ã€å­—å¹•ã€å°é¢ç­‰ï¼‰

### ğŸ” Bç«™è´¦æˆ·é›†æˆ
- **ğŸ“± æ‰«ç ç™»å½•** - æ”¯æŒ Bilibili TV æ‰«ç å¿«é€Ÿç™»å½•
- **ğŸ–¼ï¸ äºŒç»´ç ç”Ÿæˆ** - åç«¯è‡ªåŠ¨ç”Ÿæˆ PNG æ ¼å¼ç™»å½•äºŒç»´ç 
- **ğŸ”„ è‡ªåŠ¨æ£€æµ‹** - å‰ç«¯å®æ—¶è½®è¯¢æ£€æµ‹ç™»å½•çŠ¶æ€
- **ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯** - è·å–å¹¶å±•ç¤ºç”¨æˆ·åã€å¤´åƒç­‰ä¿¡æ¯
- **ğŸ’¾ çŠ¶æ€æŒä¹…åŒ–** - è‡ªåŠ¨ä¿å­˜ç™»å½• Token å’Œ Cookie
- **âš¡ çŠ¶æ€æ£€æŸ¥** - æ™ºèƒ½æ£€æµ‹è´¦æˆ·ç™»å½•çŠ¶æ€

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ğŸ–¥ï¸ åç«¯æŠ€æœ¯æ ˆ
- **è¯­è¨€**: Go 1.24+ (æ”¯æŒæœ€æ–°è¯­è¨€ç‰¹æ€§)
- **Web æ¡†æ¶**: Gin (é«˜æ€§èƒ½HTTPæ¡†æ¶)
- **ORM**: GORM v2 (æ”¯æŒå¤šæ•°æ®åº“)
- **æ•°æ®åº“**: MySQL 8.0+ / PostgreSQL 15+ / SQLite (å¼€å‘ç¯å¢ƒ)
- **æ–‡ä»¶å­˜å‚¨**: è…¾è®¯äº‘ COS (æ”¯æŒå¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ )
- **ä¾èµ–æ³¨å…¥**: Uber FX (å£°æ˜å¼ä¾èµ–ç®¡ç†)
- **å®šæ—¶ä»»åŠ¡**: Robfig Cron v3 (ç²¾ç¡®åˆ°ç§’çº§è°ƒåº¦)
- **æ—¥å¿—**: Zap + Lumberjack (ç»“æ„åŒ–æ—¥å¿—å’Œæ—¥å¿—è½®è½¬)

### ğŸŒ å‰ç«¯æŠ€æœ¯æ ˆ 
- **æ¡†æ¶**: Next.js 15+ (æ”¯æŒ App Router)
- **è¯­è¨€**: TypeScript 5.x (å®Œå…¨ç±»å‹å®‰å…¨)
- **UI åº“**: React 18 + Tailwind CSS 3.x
- **å›¾æ ‡**: Lucide React (ç°ä»£åŒ–å›¾æ ‡åº“)
- **HTTP å®¢æˆ·ç«¯**: Axios (æ”¯æŒè¯·æ±‚æ‹¦æˆªå’Œé‡è¯•)
- **æ„å»º**: é™æ€å¯¼å‡º + åµŒå…¥å¼éƒ¨ç½²

### ğŸ”— å¤–éƒ¨æœåŠ¡é›†æˆ
- **ğŸ¤ yt-dlp** - å¤šå¹³å°è§†é¢‘ä¸‹è½½ (YouTube, TikTok, ç­‰)
- **ğŸ§  Whisper AI** - é«˜ç²¾åº¦è¯­éŸ³è¯†åˆ«å’Œå­—å¹•ç”Ÿæˆ
- **ğŸŒ ç™¾åº¦ç¿»è¯‘ API** - ä¸“ä¸šæœºå™¨ç¿»è¯‘æœåŠ¡
- **ğŸ¤– DeepSeek AI** - å…ˆè¿›çš„AIç¿»è¯‘å’Œå†…å®¹ç”Ÿæˆ
- **ğŸ“º Bilibili SDK** - å®˜æ–¹è§†é¢‘ä¸Šä¼ å’Œç”¨æˆ·è®¤è¯API
- **â˜ï¸ è…¾è®¯äº‘ COS** - ä¼ä¸šçº§å¯¹è±¡å­˜å‚¨æœåŠ¡
- **ğŸ“Š æ•°æ®åˆ†æ** - å¯é€‰çš„ç”¨æˆ·è¡Œä¸ºåˆ†æå’Œç»Ÿè®¡

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ytb2bili/
â”œâ”€â”€ main.go                      # ğŸš€ åº”ç”¨ç¨‹åºå…¥å£å’Œä¾èµ–æ³¨å…¥é…ç½®
â”œâ”€â”€ Makefile                     # ğŸ“¦ è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ (å‰ç«¯+åç«¯ä¸€é”®æ‰“åŒ…)
â”œâ”€â”€ config.toml                  # âš™ï¸ ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.toml.example          # ğŸ“‹ é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ go.mod                       # ğŸ“¦ Go æ¨¡å—ä¾èµ–ç®¡ç†
â””â”€â”€ README.md                    # ğŸ“– é¡¹ç›®æ–‡æ¡£

internal/                        # ğŸ  å†…éƒ¨ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ chain_task/                  # â›“ï¸ ä»»åŠ¡é“¾å¤„ç†å¼•æ“
â”‚   â”œâ”€â”€ chain_task_handler.go    # ä»»åŠ¡é“¾æ‰§è¡Œå™¨ (å‡†å¤‡é˜¶æ®µ: å­—å¹•ç”Ÿæˆâ†’ç¿»è¯‘â†’å…ƒæ•°æ®)
â”‚   â”œâ”€â”€ upload_scheduler.go      # ä¸Šä¼ è°ƒåº¦å™¨ (å®šæ—¶ä¸Šä¼ : è§†é¢‘â†’å­—å¹•)
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â””â”€â”€ base_task.go         # ä»»åŠ¡åŸºç±»
â”‚   â”œâ”€â”€ handlers/                # ğŸ”§ å…·ä½“ä»»åŠ¡å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ generate_subtitles.go      # å­—å¹•ç”Ÿæˆ (Whisper AI)
â”‚   â”‚   â”œâ”€â”€ translate_subtitle.go      # å­—å¹•ç¿»è¯‘ (ç™¾åº¦/DeepSeek)
â”‚   â”‚   â”œâ”€â”€ generate_metadata.go       # å…ƒæ•°æ®ç”Ÿæˆ (AIæ ‡é¢˜æè¿°)
â”‚   â”‚   â”œâ”€â”€ download_img_handler.go    # å°é¢ä¸‹è½½å¤„ç†
â”‚   â”‚   â”œâ”€â”€ upload_to_bilibili.go      # è§†é¢‘ä¸Šä¼ åˆ°Bç«™
â”‚   â”‚   â”œâ”€â”€ upload_subtitle_to_bilibili.go  # å­—å¹•ä¸Šä¼ åˆ°Bç«™
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ manager/
â”‚       â”œâ”€â”€ chain.go             # ä»»åŠ¡é“¾ç®¡ç†
â”‚       â””â”€â”€ state.go             # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ core/                        # ğŸ¯ æ ¸å¿ƒä¸šåŠ¡å±‚
â”‚   â”œâ”€â”€ app_server.go            # HTTP æœåŠ¡å™¨é…ç½®
â”‚   â”œâ”€â”€ models/                  # ğŸ“Š æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_video.go          # è§†é¢‘è¡¨æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_task_step.go      # ä»»åŠ¡æ­¥éª¤æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_user.go           # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/                # ğŸ”„ ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ tb_video_service.go  # è§†é¢‘ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ task_step_service.go # ä»»åŠ¡æ­¥éª¤ç®¡ç†
â”‚   â”‚   â””â”€â”€ saved_video_service.go
â”‚   â””â”€â”€ types/
â”‚       â”œâ”€â”€ app_config.go        # åº”ç”¨é…ç½®å®šä¹‰
â”‚       â””â”€â”€ task_interface.go    # ä»»åŠ¡æ¥å£å®šä¹‰
â”œâ”€â”€ handler/                     # ğŸŒ HTTP è¯·æ±‚å¤„ç†å™¨
â”‚   â”œâ”€â”€ auth_handler.go          # è®¤è¯ç›¸å…³ API
â”‚   â”œâ”€â”€ video_handler.go         # è§†é¢‘ç®¡ç† API
â”‚   â”œâ”€â”€ upload_handler.go        # ä¸Šä¼ ç›¸å…³ API
â”‚   â”œâ”€â”€ subtitle_handler.go      # å­—å¹•å¤„ç† API
â”‚   â””â”€â”€ ...
â”œâ”€â”€ storage/                     # ğŸ’¾ å­˜å‚¨æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ interfaces.go            # å­˜å‚¨æ¥å£å®šä¹‰
â”‚   â””â”€â”€ login_store.go           # ç™»å½•çŠ¶æ€å­˜å‚¨
â””â”€â”€ web/                         # ğŸŒŸ å†…åµŒå‰ç«¯èµ„æº
    â”œâ”€â”€ static.go                # é™æ€æ–‡ä»¶æœåŠ¡å™¨
    â””â”€â”€ bili-up-web/             # Next.js ç¼–è¯‘åçš„é™æ€æ–‡ä»¶
        â”œâ”€â”€ index.html           # å‰ç«¯å…¥å£é¡µé¢
        â”œâ”€â”€ _next/               # Next.js é™æ€èµ„æº
        â””â”€â”€ ...

pkg/                             # ğŸ“š å¯é‡ç”¨ç»„ä»¶åº“
â”œâ”€â”€ analytics/                   # ğŸ“Š æ•°æ®åˆ†æå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client.go
â”‚   â””â”€â”€ middleware.go
â”œâ”€â”€ cos/                         # â˜ï¸ è…¾è®¯äº‘COSå­˜å‚¨å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ cos_client.go
â”‚   â”œâ”€â”€ cos_handler.go
â”‚   â””â”€â”€ download_utils.go
â”œâ”€â”€ logger/                      # ğŸ“ æ—¥å¿—ç»„ä»¶
â”‚   â””â”€â”€ logger.go
â”œâ”€â”€ services/                    # ğŸ› ï¸ é€šç”¨æœåŠ¡
â”‚   â””â”€â”€ subtitle_service.go
â”œâ”€â”€ store/                       # ğŸ—ƒï¸ æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ database.go              # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ migrate.go               # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ model/                   # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ translator/                  # ğŸŒ ç¿»è¯‘æœåŠ¡
â”‚   â”œâ”€â”€ baidu_translator.go      # ç™¾åº¦ç¿»è¯‘
â”‚   â”œâ”€â”€ deepseek_translator.go   # DeepSeekç¿»è¯‘
â”‚   â”œâ”€â”€ factory.go               # ç¿»è¯‘å™¨å·¥å‚
â”‚   â””â”€â”€ manager.go               # ç¿»è¯‘ç®¡ç†å™¨
â””â”€â”€ utils/                       # ğŸ§° å·¥å…·å‡½æ•°
    â”œâ”€â”€ crypto.go                # åŠ å¯†å·¥å…·
    â”œâ”€â”€ ffmpeg_utils.go          # è§†é¢‘å¤„ç†å·¥å…·
    â”œâ”€â”€ youtube_utils.go         # YouTubeå·¥å…·
    â”œâ”€â”€ ytdlp_manager.go         # yt-dlpç®¡ç†å™¨
    â””â”€â”€ ...
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

> ğŸ“š **å®Œæ•´æ„å»ºæŒ‡å—**: è¯·æŸ¥çœ‹ [BUILD_GUIDE.md](./BUILD_GUIDE.md) äº†è§£è¯¦ç»†çš„æ„å»ºå’Œéƒ¨ç½²è¯´æ˜ã€‚

### å¿«é€Ÿæ„å»ºï¼ˆä¸€é”®æ‰“åŒ…å‰ç«¯+åç«¯ï¼‰

```bash
cd bili-up-api
make build
./bili-up-api-server
```

è¿™å°†è‡ªåŠ¨ï¼š
1. æ„å»º Next.js å‰ç«¯å¹¶å¯¼å‡ºé™æ€æ–‡ä»¶
2. å°†å‰ç«¯åµŒå…¥åˆ° Go äºŒè¿›åˆ¶ä¸­
3. ç¼–è¯‘ç”Ÿæˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶

è®¿é—® `http://localhost:8096` å³å¯ä½¿ç”¨å®Œæ•´çš„å‰åç«¯åŠŸèƒ½ã€‚

### 1. ç¯å¢ƒè¦æ±‚

- Go 1.19+
- MySQL 8.0+ / PostgreSQL / SQLite
- Node.js 18+ (ç”¨äºæ„å»ºå‰ç«¯)
- Rust 1.70+ (biliup-rsï¼Œå¯é€‰)

### 2. é…ç½®æ•°æ®åº“

```sql
CREATE DATABASE bili_up CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 3. é…ç½®æ–‡ä»¶

å¤åˆ¶å¹¶ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

```bash
cp config.toml.example config.toml
```

ç¼–è¾‘ `config.toml`ï¼š

```toml
listen = ":8096"
environment = "development"
debug = true
FileUpDir = "/path/to/media"

[database]
  type = "mysql"
  host = "localhost"
  port = 3306
  username = "root"
  password = "your_password"
  database = "bili_up"

# è…¾è®¯äº‘ COS é…ç½®
[TenCosConfig]
  Enabled = true
  CosBucketURL = "https://your-bucket.cos.region.myqcloud.com"
  CosSecretId = "your_secret_id"
  CosSecretKey = "your_secret_key"
  CosRegion = "ap-guangzhou"
  CosBucket = "your-bucket"

# ç™¾åº¦ç¿»è¯‘é…ç½®
[BaiduTransConfig]
  enabled = true
  app_id = "your_app_id"
  secret_key = "your_secret_key"

# DeepSeek é…ç½®
[DeepSeekTransConfig]
  enabled = true
  api_key = "your_api_key"
  model = "deepseek-chat"
  endpoint = "https://api.deepseek.com"

```

### 4. ç¼–è¯‘è¿è¡Œ

```bash
# å®‰è£…ä¾èµ–
go mod download

# ç¼–è¯‘
go build -o bili_up_backend main.go

# è¿è¡Œ
./bili_up_backend
```

---

## ğŸ“– API æ–‡æ¡£

### è§†é¢‘ç®¡ç†

#### è·å–è§†é¢‘åˆ—è¡¨
```http
GET /api/v1/videos
```

#### è·å–è§†é¢‘è¯¦æƒ…ï¼ˆå«ä»»åŠ¡æ­¥éª¤ï¼‰
```http
GET /api/v1/videos/:id
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "code": 200,
  "data": {
    "id": 1,
    "title": "è§†é¢‘æ ‡é¢˜",
    "description": "è§†é¢‘æè¿°",
    "cover_url": "å°é¢URL",
    "status": "completed",
    "task_steps": [
      {
        "step_name": "download_video",
        "step_order": 1,
        "status": "completed",
        "duration": 120,
        "can_retry": false
      },
      // ... å…¶ä»–æ­¥éª¤
    ]
  }
}
```

#### é‡è¯•ä»»åŠ¡æ­¥éª¤
```http
POST /api/v1/videos/:id/steps/:stepName/retry
```

#### è·å–è§†é¢‘æ–‡ä»¶åˆ—è¡¨
```http
GET /api/v1/videos/:id/files
```

### è®¤è¯ç›¸å…³

#### è·å–ç™»å½•äºŒç»´ç 
```http
GET /api/v1/auth/qrcode
```

#### è·å–äºŒç»´ç å›¾ç‰‡
```http
GET /api/v1/auth/qrcode/image/:authCode
```

#### è½®è¯¢ç™»å½•çŠ¶æ€
```http
POST /api/v1/auth/poll
Body: {"auth_code": "xxx"}
```

#### æ£€æŸ¥ç™»å½•çŠ¶æ€
```http
GET /api/v1/auth/status
```

#### è·å–ç”¨æˆ·ä¿¡æ¯
```http
GET /api/v1/auth/userinfo
```

#### ç™»å‡º
```http
POST /api/v1/auth/logout
```

---



## ğŸ¯ ä»»åŠ¡å¤„ç†æµç¨‹

### 6æ­¥å¤„ç†é“¾

1. **download_video** - ä¸‹è½½è§†é¢‘
   - æ”¯æŒå¤šå¹³å°ï¼ˆBç«™ã€æŠ–éŸ³ã€YouTube ç­‰ï¼‰
   - è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¸…æ™°åº¦
   - ä¿å­˜åˆ°æœ¬åœ°æˆ–äº‘å­˜å‚¨

2. **generate_subtitles** - ç”Ÿæˆå­—å¹•
   - ä½¿ç”¨ Whisper AI è¯­éŸ³è¯†åˆ«
   - è‡ªåŠ¨æ–­å¥å’Œæ—¶é—´è½´
   - æ”¯æŒå¤šè¯­è¨€è¯†åˆ«

3. **translate_subtitles** - ç¿»è¯‘å­—å¹•
   - ç™¾åº¦ç¿»è¯‘æˆ– DeepSeek AI
   - ä¿ç•™å­—å¹•æ ¼å¼å’Œæ—¶é—´è½´
   - æ”¯æŒå¤šè¯­è¨€ç¿»è¯‘

4. **generate_metadata** - ç”Ÿæˆå…ƒæ•°æ®
   - AI åˆ†æè§†é¢‘å†…å®¹
   - ç”Ÿæˆæ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾
   - ç¬¦åˆ Bç«™ SEO è§„èŒƒ

5. **upload_to_bilibili** - ä¸Šä¼ è§†é¢‘
   - åˆ†ç‰‡ä¸Šä¼ æ”¯æŒå¤§æ–‡ä»¶
   - è‡ªåŠ¨é‡è¯•æœºåˆ¶
   - å®æ—¶è¿›åº¦åé¦ˆ

6. **upload_subtitles** - ä¸Šä¼ å­—å¹•
   - æ”¯æŒåŒè¯­å­—å¹•
   - è‡ªåŠ¨å…³è”è§†é¢‘
   - SRT/ASS æ ¼å¼æ”¯æŒ

### ä»»åŠ¡çŠ¶æ€

- `pending` - ç­‰å¾…æ‰§è¡Œ
- `running` - æ‰§è¡Œä¸­
- `completed` - å·²å®Œæˆ
- `failed` - å¤±è´¥
- `skipped` - è·³è¿‡

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
go test ./...
```

### API æµ‹è¯•

ä½¿ç”¨æä¾›çš„æµ‹è¯•è„šæœ¬ï¼š

```bash
# æµ‹è¯•åº”ç”¨è®¤è¯
./test_app_auth.sh

# æµ‹è¯•è§†é¢‘ä¸Šä¼ ï¼ˆéœ€è¦å…ˆç™»å½•ï¼‰
curl http://localhost:8096/api/v1/videos

# æµ‹è¯•è®¤è¯çŠ¶æ€
curl http://localhost:8096/api/v1/auth/status
```

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### videos è¡¨
```sql
CREATE TABLE videos (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  title VARCHAR(255),
  description TEXT,
  cover_url VARCHAR(512),
  file_path VARCHAR(512),
  status VARCHAR(50),
  bilibili_bvid VARCHAR(50),
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

### task_steps è¡¨
```sql
CREATE TABLE task_steps (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  video_id BIGINT,
  step_name VARCHAR(100),
  step_order INT,
  status VARCHAR(50),
  start_time TIMESTAMP,
  end_time TIMESTAMP,
  duration INT,
  error_msg TEXT,
  result_data JSON,
  can_retry BOOLEAN,
  created_at TIMESTAMP,
  updated_at TIMESTAMP,
  FOREIGN KEY (video_id) REFERENCES videos(id)
);
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯**: `Error 1045: Access denied`

**è§£å†³**:
1. æ£€æŸ¥ `config.toml` ä¸­çš„æ•°æ®åº“é…ç½®
2. ç¡®è®¤ MySQL æœåŠ¡æ­£åœ¨è¿è¡Œ
3. éªŒè¯ç”¨æˆ·åå’Œå¯†ç 

### é—®é¢˜2: Bç«™ç™»å½•å¤±è´¥

**é”™è¯¯**: äºŒç»´ç è¿‡æœŸæˆ–æ— æ³•æ‰«æ

**è§£å†³**:
1. åˆ·æ–°é¡µé¢é‡æ–°è·å–äºŒç»´ç 
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. ç¡®è®¤ Bç«™è´¦å·çŠ¶æ€æ­£å¸¸

### é—®é¢˜3: è§†é¢‘ä¸Šä¼ å¤±è´¥

**é”™è¯¯**: ä¸Šä¼ è¶…æ—¶æˆ–ä¸­æ–­

**è§£å†³**:
1. æ£€æŸ¥ç½‘ç»œé€Ÿåº¦
2. å°è¯•å‡å°è§†é¢‘æ–‡ä»¶å¤§å°
3. æŸ¥çœ‹ Bç«™è´¦å·æ˜¯å¦æœ‰ä¸Šä¼ æƒé™
4. æ£€æŸ¥ Token æ˜¯å¦è¿‡æœŸ

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

## ğŸ“„ è®¸å¯è¯

MIT License

---
